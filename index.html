<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter+Tight:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/main.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/x-icon" href="icons/192.ico">
    <meta name="theme-color" content="#FFCC00">
    <title>–¢—Ä–µ–∫–µ—Ä –∑–∞–≤–¥–∞–Ω—å <br> –í–æ–ª–∏–Ω—Å—å–∫–æ–≥–æ –í—ñ—Å–Ω–∏–∫–∞</title>
</head>
<body>
    <h1 class="main_text">–¢—Ä–µ–∫–µ—Ä –∑–∞–≤–¥–∞–Ω—å <br> –í–æ–ª–∏–Ω—Å—å–∫–æ–≥–æ –í—ñ—Å–Ω–∏–∫–∞</h1>
  
    <!-- Top actions -->
    <div class="top-actions">
      <button id="add-board-btn" class="add-board-btn" title="–î–æ–¥–∞—Ç–∏ —Ç–∞–π—Ç–ª">Ôºã –î–æ–¥–∞—Ç–∏ —Ç–∞–π—Ç–ª</button>
    </div>
  
    <!-- –ö–æ—Ä–æ—Ç–∫–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è -->
    <div class="quick-instructions">
      <ul>
        <li>‚ûï –î–æ–¥–∞–≤–∞–π—Ç–µ —Ç–∞–π—Ç–ª–∏ —Ç–∞ –∑–∞–≤–¥–∞–Ω–Ω—è –ø—ñ–¥ –Ω–∏—Ö</li>
        <li>üñ±Ô∏è –ü–µ—Ä–µ—Ç—è–≥—É–π—Ç–µ –∑–∞–≤–¥–∞–Ω–Ω—è –º—ñ–∂ –∫–æ–ª–æ–Ω–∫–∞–º–∏ –≤ –º–µ–∂–∞—Ö —Ç–∞–π—Ç–ª—É</li>
        <li>üóëÔ∏è –î–≤—ñ—á—ñ –∫–ª—ñ–∫–Ω—ñ—Ç—å –Ω–∞ –∑–∞–≤–¥–∞–Ω–Ω—è, —â–æ–± –≤–∏–¥–∞–ª–∏—Ç–∏</li>
      </ul>
    </div>
  
    <!-- Modal: Add Task -->
    <div id="modal-task" class="modal-task" style="display:none;">
      <div class="modal-task-content">
        <span class="modal-task-close" id="modal-task-close">&times;</span>
        <h2>–î–æ–¥–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è</h2>
        <form id="modal-task-form">
          <label for="modal-task-title">–ù–∞–∑–≤–∞ –∑–∞–≤–¥–∞–Ω–Ω—è</label>
          <input type="text" id="modal-task-title" name="title" required maxlength="50">
  
          <label for="modal-task-url">Google Doc URL</label>
          <input type="url" id="modal-task-url" name="url" required placeholder="https://docs.google.com/...">
  
          <input type="hidden" id="modal-task-target-board" name="targetBoard">
          <input type="hidden" id="modal-task-target-column" name="targetColumn">
          <button type="submit" id="modal-task-submit">–î–æ–¥–∞—Ç–∏</button>
        </form>
      </div>
    </div>

    <!-- Modal: Add Board (Title) -->
    <div id="modal-board" class="modal-task" style="display:none;">
      <div class="modal-task-content">
        <span class="modal-task-close" id="modal-board-close">&times;</span>
        <div class="modal-task-header">
          <h2>–î–æ–¥–∞—Ç–∏ —Ç–∞–π—Ç–ª</h2>
        </div>
        <form id="modal-board-form" class="modal-form">
          <div class="form-row">
            <label for="modal-board-name">–ù–∞–∑–≤–∞ —Ç–∞–π—Ç–ª—É</label>
            <input type="text" id="modal-board-name" name="boardName" required maxlength="80" placeholder='–ù–∞–ø—Ä.: "–Ü—Å—Ç–æ—Ä—ñ—è –ø—Ä–æ –í–æ–ª–∏–Ω—å"'>
          </div>
          <div class="modal-actions">
            <button type="button" class="btn btn-outline" id="modal-board-cancel">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
            <button type="submit" class="btn btn-primary" id="modal-board-submit">–°—Ç–≤–æ—Ä–∏—Ç–∏</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal: Rename Board -->
    <div id="modal-rename-board" class="modal-task" style="display:none;">
      <div class="modal-task-content">
        <span class="modal-task-close" id="modal-rename-board-close">&times;</span>
        <div class="modal-task-header">
          <h2>–ü–µ—Ä–µ–π–º–µ–Ω—É–≤–∞—Ç–∏ —Ç–∞–π—Ç–ª</h2>
        </div>
        <form id="modal-rename-board-form" class="modal-form">
          <input type="hidden" id="rename-board-id">
          <div class="form-row">
            <label for="rename-board-name">–ù–æ–≤–∞ –Ω–∞–∑–≤–∞</label>
            <input type="text" id="rename-board-name" required maxlength="80" placeholder="–í–≤–µ–¥—ñ—Ç—å –Ω–æ–≤—É –Ω–∞–∑–≤—É">
          </div>
          <div class="modal-actions">
            <button type="button" class="btn btn-outline" id="rename-board-cancel">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
            <button type="submit" class="btn btn-primary">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal: Delete Board -->
    <div id="modal-delete-board" class="modal-task" style="display:none;">
      <div class="modal-task-content">
        <span class="modal-task-close" id="modal-delete-board-close">&times;</span>
        <div class="modal-task-header">
          <h2>–í–∏–¥–∞–ª–∏—Ç–∏ —Ç–∞–π—Ç–ª</h2>
        </div>
        <div class="modal-body">
          <input type="hidden" id="delete-board-id">
          <p>–°–ø—Ä–∞–≤–¥—ñ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ç–∞–π—Ç–ª <strong id="delete-board-title"></strong> —Ä–∞–∑–æ–º —ñ–∑ —É—Å—ñ–º–∞ –∫–∞—Ä—Ç–∫–∞–º–∏?</p>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-outline" id="delete-board-cancel">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
          <button type="button" class="btn btn-danger" id="delete-board-confirm">–í–∏–¥–∞–ª–∏—Ç–∏</button>
        </div>
      </div>
    </div>

        <!-- Modal: Notifications help -->
    <div id="modal-notify" class="modal-task" style="display:none;">
      <div class="modal-task-content">
        <span class="modal-task-close" id="modal-notify-close">&times;</span>
        <div class="modal-task-header"><h2>–°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ –Ω–æ–≤—ñ –∑–∞–¥–∞—á—ñ</h2></div>
        <div class="modal-body" id="notify-body" style="display:flex;flex-direction:column;gap:10px;">
          <p>–£–≤—ñ–º–∫–Ω—ñ—Ç—å –≤–µ–±-—Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è, —â–æ–± –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –ø—É—à—ñ –¥–ª—è –æ–±—Ä–∞–Ω–æ—ó –∫–æ–ª–æ–Ω–∫–∏.</p>
          <ul style="margin-left:16px;">
            <li>–î–æ–∑–≤–æ–ª—å—Ç–µ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è —É –±—Ä–∞—É–∑–µ—Ä—ñ</li>
            <li>–£ –∫–æ—Ä–µ–Ω—ñ —Å–∞–π—Ç—É –º–∞—î –±—É—Ç–∏ <code>/firebase-messaging-sw.js</code></li>
            <li>–£ Firebase Console ‚Üí Cloud Messaging –≤—Å—Ç–∞–≤—Ç–µ Web Push (VAPID) –∫–ª—é—á</li>
          </ul>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-outline" id="notify-cancel">–ó–∞–∫—Ä–∏—Ç–∏</button>
          <button type="button" class="btn btn-primary" id="notify-try">–ù–∞–¥–∞—Ç–∏ –¥–æ–∑–≤—ñ–ª</button>
        </div>
      </div>
    </div>
  
    <!-- Boards container: each board has its own 3 columns -->
    <div id="boards" class="boards"></div>
  
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <!-- Firebase Messaging + Functions (compat) -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-messaging-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-functions-compat.js"></script>
    <script src="js/firebase-config.js"></script>
    <script src="js/script.js" defer></script>
    <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.addEventListener('controllerchange', () => {
          // –∫–æ–ª–∏ –∞–∫—Ç–∏–≤—É—î—Ç—å—Å—è –Ω–æ–≤–∏–π SW ‚Äî –æ–Ω–æ–≤–∏—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É
          window.location.reload();
        });

        window.addEventListener('load', () => {
          // –í–ê–ñ–õ–ò–í–û: –≤—ñ–¥–Ω–æ—Å–Ω–∏–π —à–ª—è—Ö —ñ –ª–æ–∫–∞–ª—å–Ω–∏–π scope –¥–ª—è /taskapp/
          navigator.serviceWorker.register('./service-worker.js', { scope: './' })
            .then(reg => console.log('SW registered', reg.scope))
            .catch(err => console.log('SW registration failed', err));
        });
      }
    </script>
  </body>
</html>